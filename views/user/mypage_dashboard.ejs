<% include ../sub/header %>
<% include ../sub/mypage_menu %>
<h1>대시보드</h1>

<table class="table table-hover">
  <thead>
    <th>메세지</th>
    <th>업데이트</th>
    <th>관리</th>
  </thead>
  <tbody>
    <tr v-for="(notification, i) in results" :key="i">
      <td>

        <a v-if="notification.is_read == 0" v-bind:href="'/notification/read/' + notification.notification_id">
          <strong>
            {{makeDisplayMsg(notification)}}
          </strong>
        </a>
        
        <a v-else v-bind:href="'/notification/read/' + notification.notification_id">
          {{makeDisplayMsg(notification)}}
        </a>

      </td>
      <td>{{notification.datetime_last_updated}}</td>
      <td>
        <button type="button" class="btn btn-danger" 
          @click="deleteNotification($event, notification.notification_id)">
          삭제
          </button>
      </td>
    </tr>
  </tbody>
</table>
</main>

<footer>
  <% include ../sub/footer %>
</footer>
</div>

<script>
  var global = makeGlobal();
  var app = new Vue({
    el: '#app',
    data: function () {
      return {
        header_menu_name: global.getHeaderMenuName("<%-pagename %>"),
        mypage_menu_name: global.getMypageMenuName("<%-pagename %>"),
        is_user: <%- is_user %>,
        is_admin: <%- is_admin %>,
        results : <%-JSON.stringify(results) %>,
        list_count : <%-JSON.stringify(list_count) %>,
      }
    },
    methods: {
      makeDisplayMsg: function(notification) {
        var message = '"' + notification.title +'"'
        switch (notification.notification_type) {
          case 1:
            message += ' 예약 상태가 변경되었습니다'
            break;
          case 2:
            message += ' 예약 정보가 변경되었습니다'
            break;
          default:
            break;
        }
        message += ' (' + notification.notification_count +')'
        return message;
      },
      deleteNotification: function(notification_id) {
        return '테스트';
      },
    }
  })
</script>

</body>

</html>