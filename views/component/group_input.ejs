<script>
  Vue.component('group-input', {
    template: `
      <form class="form-lnline" v-on:submit="onSubmitForm">
        <div class="form-group">
          <label class="col-sm-2 control-label">학과</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{group.department_name}}</p>
          <div/>
        </div>
        <div class="form-group">
          <label class="col-sm-2 control-label">학습관</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{group.building_name}}</p>
          <div/>
        </div>
        <div class="form-group">
          <label class="col-sm-2 control-label">대표</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{group.representative_name}}</p>
          <div/>
        </div>
        <div class="form-group">
          <label class="col-sm-2 control-label">이름</label>
          <div class="col-sm-10">
            <input type="text" class="form-control" v-model="group.name" :disabled="mod == 'GET'">
          <div/>
        </div>
        <div class="form-group">
          <label class="col-sm-2 control-label">설명</label>
          <div class="col-sm-10">
            <textarea class="form-control" rows="3" v-model="group.description" :disabled="mod == 'GET'"></textarea>
          <div/>
        </div>
        <div class="form-group">
          <label class="col-sm-2 control-label">생성일</label>
          <div class="col-sm-10">
            <p class="form-control-static">{{group.date_created}}</p>
          <div/>
        </div>
        <button type="submit" class="btn btn-primary" v-if="mod=='POST'">제출</button>
        <div v-if="group.is_mine==1">
          <button type="button" class="btn btn-warning" v-if="mod=='GET'" @click="chageMod($event, 'PUT')">수정</button>
          <button type="submit" class="btn btn-primary" v-if="mod=='PUT'">제출</button>
        </div>
      </form>
    `,
    props: ['mod', 'group'],
    data: function () {
      return {
        mod: this.mod,
        group: this.group,
      }
    }, 
    methods: {
      chageMod : function(e, mod) {
        e.preventDefault();
        this.mod = mod;
      },
      onSubmitForm: function(e) {
        e.preventDefault();
        var mod = this.mod;
        this.mod = 'GET';
        var url = '/api/study_group' + (mod == 'PUT' ? '/'+ this.group.study_group_id : '');
        global.ajax({
          url: url,
          type: mod,
          data: this.group,
        },
        function (data, status) {
          alert(data.message);
        },
        function (message, status, data) {
          alert(message);
        });
      }
    },
  })
</script>